resource "random_string" "hash" {
  length  = 16
  special = false
}

resource "aws_lb" "{{ name }}" {
  name               = "${var.lb_name}"
  name_prefix        = "${random_string.hash.result}"
  internal           = "${var.lb_internal}"
  load_balancer_type = "${var.lb_load_balancer_type}"
  security_groups    = ["${var.lb_security_groups}"]
  subnets            = ["${var.lb_subnets}"]

  access_logs {
    bucket  = "${var.lb_log_bucket}"
    prefix  = "${var.lb_log_prefix}"
    enabled = "${var.lb_log_enabled}"
  }

  idle_timeout                     = "${var.lb_idle_timeout}"
  enable_deletion_protection       = "${var.lb_enable_deletion_protection}"
  enable_cross_zone_load_balancing = "${var.lb_enable_cross_zone_load_balancing}"
  enable_http2                     = "${var.lb_enable_http2}"

  tags = "${merge(var.default_tags, var.custom_tags)}"
}